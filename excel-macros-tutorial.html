<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutorial Interactivo: Macros en Excel</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
            background-size: 300% 300%;
            animation: gradientShift 8s ease infinite;
            min-height: 100vh;
            color: #2d3748;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            animation: fadeInDown 1s ease-out;
            position: relative;
            padding: 40px 0;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 200px;
            background: linear-gradient(45deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            border-radius: 50%;
            animation: pulse 3s ease-in-out infinite;
            z-index: 1;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: translateX(-50%) scale(1);
                opacity: 0.7;
            }

            50% {
                transform: translateX(-50%) scale(1.1);
                opacity: 1;
            }
        }

        .header h1 {
            font-size: 3.5rem;
            margin-bottom: 15px;
            text-shadow:
                0 0 20px rgba(255, 255, 255, 0.5),
                0 0 40px rgba(255, 255, 255, 0.3),
                0 0 60px rgba(255, 255, 255, 0.1);
            font-weight: 800;
            letter-spacing: 2px;
            position: relative;
            z-index: 2;
            background: linear-gradient(45deg, #ffffff, #f0f0f0, #ffffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1.4rem;
            opacity: 0.95;
            font-weight: 300;
            position: relative;
            z-index: 2;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            height: 14px;
            margin: 30px 0;
            overflow: hidden;
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            box-shadow:
                0 4px 15px rgba(0, 0, 0, 0.1),
                inset 0 2px 4px rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00d4ff, #5a67d8, #ed64a6, #f093fb);
            width: 0%;
            transition: width 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            border-radius: 25px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: progressShine 2s ease-in-out infinite;
        }

        @keyframes progressShine {
            0% {
                left: -100%;
            }

            100% {
                left: 100%;
            }
        }

        .lesson-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .lesson-card {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            box-shadow:
                0 8px 32px rgba(0, 0, 0, 0.1),
                0 4px 16px rgba(0, 0, 0, 0.05);
        }

        .lesson-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb, #f5576c);
            transform: scaleX(0);
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transform-origin: left;
        }

        .lesson-card:hover::before {
            transform: scaleX(1);
        }

        .lesson-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow:
                0 20px 60px rgba(0, 0, 0, 0.15),
                0 10px 30px rgba(0, 0, 0, 0.1);
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .lesson-card.completed {
            background: linear-gradient(135deg,
                    rgba(16, 185, 129, 0.2) 0%,
                    rgba(5, 150, 105, 0.1) 100%);
            border-color: rgba(16, 185, 129, 0.5);
            box-shadow:
                0 8px 32px rgba(16, 185, 129, 0.2),
                0 4px 16px rgba(16, 185, 129, 0.1);
        }

        .lesson-card.active {
            background: linear-gradient(135deg,
                    rgba(239, 68, 68, 0.2) 0%,
                    rgba(245, 101, 101, 0.1) 100%);
            border-color: rgba(239, 68, 68, 0.5);
            box-shadow:
                0 8px 32px rgba(239, 68, 68, 0.2),
                0 4px 16px rgba(239, 68, 68, 0.1);
        }

        .lesson-card h3 {
            color: rgba(255, 255, 255, 0.95);
            margin-bottom: 15px;
            font-size: 1.4rem;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .lesson-card p {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 20px;
            line-height: 1.6;
            font-size: 1rem;
        }

        .lesson-duration {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.1);
            padding: 6px 12px;
            border-radius: 20px;
            display: inline-block;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .lesson-content {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 40px;
            margin-top: 30px;
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow:
                0 20px 60px rgba(0, 0, 0, 0.1),
                0 10px 30px rgba(0, 0, 0, 0.05);
            position: relative;
            opacity: 1;
            transform: translateY(0);
            transition: all 0.3s ease;
        }

        .lesson-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb, #f5576c);
            border-radius: 25px 25px 0 0;
        }

        .lesson-content.active {
            display: block;
        }

        .lesson-content h2 {
            color: #2d3748;
            margin-bottom: 25px;
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            border-bottom: 3px solid transparent;
            border-image: linear-gradient(90deg, #667eea, #764ba2) 1;
            padding-bottom: 15px;
            position: relative;
        }

        .lesson-content h2::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 2px;
        }

        /* Estilos para listas en el contenido de las lecciones */
        .lesson-content ul {
            margin: 20px 0;
            padding-left: 30px;
        }

        .lesson-content ol {
            margin: 20px 0;
            padding-left: 30px;
        }

        .lesson-content li {
            margin-bottom: 12px;
            line-height: 1.6;
            color: #4a5568;
            font-size: 1rem;
            position: relative;
        }

        .lesson-content ul li {
            list-style: none;
            padding-left: 25px;
        }

        .lesson-content ul li::before {
            content: '';
            position: absolute;
            left: 0;
            top: 8px;
            width: 8px;
            height: 8px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);
        }

        .lesson-content ol li {
            padding-left: 10px;
            counter-increment: step-counter;
        }

        .lesson-content ol {
            counter-reset: step-counter;
        }

        .lesson-content ol li::marker {
            color: #667eea;
            font-weight: 700;
        }

        /* Estilos espec√≠ficos para listas anidadas */
        .lesson-content ul ul,
        .lesson-content ol ol {
            margin: 8px 0;
            padding-left: 25px;
        }

        .lesson-content ul ul li::before {
            width: 6px;
            height: 6px;
            background: linear-gradient(135deg, #f093fb, #f5576c);
        }

        /* Mejoras para elementos strong dentro de listas */
        .lesson-content li strong {
            color: #2d3748;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .code-example {
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 100%);
            color: #e2e8f0;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
            overflow-x: auto;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow:
                0 10px 30px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .code-example::before {
            content: 'VBA';
            position: absolute;
            top: -12px;
            right: 15px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .code-example::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, #667eea, #764ba2);
            border-radius: 0 0 0 15px;
        }

        .interactive-exercise {
            background: linear-gradient(135deg,
                    rgba(102, 126, 234, 0.1) 0%,
                    rgba(118, 75, 162, 0.05) 100%);
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            position: relative;
            overflow: hidden;
            box-shadow:
                0 10px 30px rgba(102, 126, 234, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .interactive-exercise::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 20px 20px 0 0;
        }

        .exercise-title {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .exercise-title::before {
            content: 'üíª';
            font-size: 1.5rem;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .exercise-input {
            width: 100%;
            padding: 15px;
            border: 2px solid rgba(102, 126, 234, 0.2);
            border-radius: 12px;
            margin-bottom: 15px;
            font-family: 'Fira Code', 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            resize: vertical;
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
            box-shadow:
                0 4px 12px rgba(0, 0, 0, 0.05),
                inset 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .exercise-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow:
                0 0 0 3px rgba(102, 126, 234, 0.1),
                0 4px 12px rgba(0, 0, 0, 0.1);
            background: rgba(255, 255, 255, 0.95);
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            margin: 8px;
            box-shadow:
                0 4px 15px rgba(102, 126, 234, 0.3),
                0 2px 8px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow:
                0 8px 25px rgba(102, 126, 234, 0.4),
                0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d, #495057);
        }

        .btn-success {
            background: linear-gradient(135deg, #00c851, #007e33);
        }

        .feedback {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 500;
            display: none;
        }

        .feedback.success {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            border: 1px solid #10b981;
            color: #065f46;
            box-shadow:
                0 4px 15px rgba(16, 185, 129, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .feedback.error {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border: 1px solid #ef4444;
            color: #991b1b;
            box-shadow:
                0 4px 15px rgba(239, 68, 68, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .tip-box {
            background: linear-gradient(135deg, #fef3c7, #fcd34d);
            border: 1px solid #f59e0b;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
            box-shadow:
                0 8px 25px rgba(245, 158, 11, 0.2),
                0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .tip-box::before {
            content: 'üí°';
            position: absolute;
            top: -10px;
            left: -25px;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            padding: 10px 10px;
            border-radius: 50%;
            font-size: 1.2rem;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }

        .tip-box strong {
            color: #92400e;
            font-weight: 700;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow:
                0 8px 25px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }

        .lesson-counter {
            color: rgba(255, 255, 255, 0.95);
            font-size: 1.2rem;
            font-weight: 700;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-40px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }

            50% {
                opacity: 1;
                transform: scale(1.05);
            }

            70% {
                transform: scale(0.9);
            }

            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Efectos de part√≠culas flotantes */
        .floating-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        .particle:nth-child(1) {
            left: 10%;
            animation-delay: 0s;
        }

        .particle:nth-child(2) {
            left: 20%;
            animation-delay: 1s;
        }

        .particle:nth-child(3) {
            left: 30%;
            animation-delay: 2s;
        }

        .particle:nth-child(4) {
            left: 40%;
            animation-delay: 3s;
        }

        .particle:nth-child(5) {
            left: 50%;
            animation-delay: 4s;
        }

        .particle:nth-child(6) {
            left: 60%;
            animation-delay: 5s;
        }

        .particle:nth-child(7) {
            left: 70%;
            animation-delay: 6s;
        }

        .particle:nth-child(8) {
            left: 80%;
            animation-delay: 7s;
        }

        .particle:nth-child(9) {
            left: 90%;
            animation-delay: 8s;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }

            10% {
                opacity: 1;
            }

            90% {
                opacity: 1;
            }

            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        /* Mejoras responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }

            .lesson-selector {
                grid-template-columns: 1fr;
            }

            .navigation {
                flex-direction: column;
                gap: 20px;
                padding: 20px;
            }

            .lesson-content {
                padding: 25px;
            }

            .code-example {
                padding: 20px;
                font-size: 13px;
            }

            .interactive-exercise {
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 2rem;
            }

            .lesson-card {
                padding: 20px;
            }

            .lesson-content {
                padding: 20px;
            }

            .btn {
                padding: 12px 20px;
                font-size: 0.9rem;
            }
        }

        /* Animaciones para elementos espec√≠ficos */
        .lesson-card:nth-child(even) {
            animation: slideInLeft 0.6s ease-out;
        }

        .lesson-card:nth-child(odd) {
            animation: slideInRight 0.6s ease-out;
        }

        .code-example {
            animation: fadeIn 0.8s ease-out;
        }

        .interactive-exercise {
            animation: bounceIn 0.6s ease-out;
        }

        .quiz-container {
            animation: fadeIn 0.8s ease-out;
        }

        /* Efectos de hover mejorados */
        .lesson-card:hover h3 {
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
        }

        .btn:hover {
            animation: pulse 0.5s ease-in-out;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        .completion-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow:
                0 4px 15px rgba(16, 185, 129, 0.4),
                0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .lesson-card.completed .completion-badge {
            opacity: 1;
            transform: scale(1.1);
        }

        .quiz-container {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid #cbd5e0;
            box-shadow:
                0 10px 30px rgba(0, 0, 0, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            position: relative;
        }

        .quiz-container::before {
            content: 'üéØ';
            position: absolute;
            top: -12px;
            left: 25px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 8px 12px;
            border-radius: 50%;
            font-size: 1.1rem;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .quiz-question {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #2d3748;
            font-weight: 600;
            margin-top: 15px;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            background: rgba(255, 255, 255, 0.8);
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
        }

        .quiz-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .quiz-option:hover::before {
            left: 100%;
        }

        .quiz-option:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
            transform: translateX(5px);
            box-shadow:
                0 4px 15px rgba(102, 126, 234, 0.2),
                0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .quiz-option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateX(5px);
            box-shadow:
                0 4px 15px rgba(102, 126, 234, 0.3),
                0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .quiz-option.correct {
            border-color: #10b981;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            box-shadow:
                0 4px 15px rgba(16, 185, 129, 0.3),
                0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .quiz-option.incorrect {
            border-color: #ef4444;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            box-shadow:
                0 4px 15px rgba(239, 68, 68, 0.3),
                0 2px 8px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .lesson-selector {
                grid-template-columns: 1fr;
            }

            .navigation {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>

<body>
    <!-- Part√≠culas flotantes de fondo -->
    <div class="floating-particles">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>

    <div class="container">
        <div class="header">
            <h1>üöÄ Macros en Excel</h1>
            <p>Domina la automatizaci√≥n de Excel con VBA</p>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="lesson-selector" id="lessonSelector">
            <!-- Las lecciones se generar√°n din√°micamente -->
        </div>

        <div class="lesson-content" id="lessonContent">
            <!-- El contenido de las lecciones se mostrar√° aqu√≠ -->
        </div>

        <div class="navigation">
            <button class="btn btn-secondary" id="prevBtn" onclick="navigateLesson(-1)">‚Üê Anterior</button>
            <div class="lesson-counter">
                <span id="currentLesson">1</span> / <span id="totalLessons">10</span>
            </div>
            <button class="btn" id="nextBtn" onclick="navigateLesson(1)">Siguiente ‚Üí</button>
        </div>
    </div>

    <script>
        // Datos del curso
        const lessons = [
            {
                id: 1,
                title: "Introducci√≥n a las Macros",
                description: "Qu√© son las macros y por qu√© son importantes en Excel",
                duration: "15 min",
                content: `
                    <h2>¬øQu√© son las Macros en Excel?</h2>
                    <p>Las macros son secuencias de comandos y instrucciones que automatizan tareas repetitivas en Excel. Son como "recetas" que le dicen a Excel exactamente qu√© hacer paso a paso.</p>
                    
                    <h3>Ventajas de usar Macros:</h3>
                    <ul>
                        <li>üöÄ <strong>Automatizaci√≥n:</strong> Elimina tareas repetitivas</li>
                        <li>‚ö° <strong>Eficiencia:</strong> Reduce el tiempo de trabajo</li>
                        <li>üéØ <strong>Precisi√≥n:</strong> Minimiza errores humanos</li>
                        <li>üîÑ <strong>Consistencia:</strong> Garantiza resultados uniformes</li>
                    </ul>

                    <div class="tip-box">
                        <strong>Consejo:</strong> Las macros se escriben en VBA (Visual Basic for Applications), un lenguaje de programaci√≥n integrado en Excel.
                    </div>

                    <h3>Ejemplos de tareas que puedes automatizar:</h3>
                    <ul>
                        <li>Formatear datos autom√°ticamente</li>
                        <li>Generar reportes peri√≥dicos</li>
                        <li>Importar y procesar datos</li>
                        <li>Crear gr√°ficos din√°micos</li>
                        <li>Enviar emails desde Excel</li>
                    </ul>

                    <div class="interactive-exercise">
                        <div class="exercise-title">üéØ Reflexi√≥n Inicial</div>
                        <p>Piensa en 3 tareas repetitivas que realizas frecuentemente en Excel:</p>
                        <textarea class="exercise-input" placeholder="Escribe aqu√≠ tus tareas repetitivas..." rows="4"></textarea>
                        <button class="btn" onclick="completeExercise(1)">Completar Reflexi√≥n</button>
                        <div class="feedback" id="feedback1"></div>
                    </div>
                `,
                quiz: {
                    question: "¬øCu√°l es la principal ventaja de usar macros en Excel?",
                    options: [
                        "Hacer que Excel se vea m√°s bonito",
                        "Automatizar tareas repetitivas y ahorrar tiempo",
                        "Aumentar el tama√±o de los archivos",
                        "Complicar el trabajo diario"
                    ],
                    correct: 1
                }
            },
            {
                id: 2,
                title: "Configuraci√≥n y Seguridad",
                description: "Habilitar macros y configurar la seguridad en Excel",
                duration: "10 min",
                content: `
                    <h2>Configuraci√≥n de Macros en Excel</h2>
                    <p>Antes de trabajar con macros, necesitas configurar Excel correctamente para permitir su ejecuci√≥n.</p>

                    <h3>Pasos para habilitar macros:</h3>
                    <ol>
                        <li><strong>Archivo</strong> ‚Üí <strong>Opciones</strong></li>
                        <li><strong>Centro de confianza</strong> ‚Üí <strong>Configuraci√≥n del Centro de confianza</strong></li>
                        <li><strong>Configuraci√≥n de macros</strong></li>
                        <li>Seleccionar: <strong>"Habilitar todas las macros"</strong> (para desarrollo)</li>
                    </ol>

                    <div class="tip-box">
                        <strong>Importante:</strong> Solo habilites macros de fuentes confiables. Las macros pueden ejecutar c√≥digo malicioso.
                    </div>

                    <h3>Niveles de seguridad:</h3>
                    <ul>
                        <li>üîí <strong>Deshabilitar todas las macros:</strong> M√°xima seguridad</li>
                        <li>üîê <strong>Deshabilitar con notificaci√≥n:</strong> Recomendado para usuarios</li>
                        <li>üîì <strong>Habilitar todas las macros:</strong> Para desarrollo</li>
                    </ul>

                    <h3>Acceso al Editor VBA:</h3>
                    <p>Para acceder al editor de VBA, usa el atajo <strong>Alt + F11</strong> o ve a:</p>
                    <p><strong>Desarrollador</strong> ‚Üí <strong>Visual Basic</strong></p>

                    <div class="interactive-exercise">
                        <div class="exercise-title">‚úÖ Lista de Verificaci√≥n</div>
                        <p>Marca las configuraciones que has completado:</p>
                        <label><input type="checkbox" class="config-check"> Habilitado el men√∫ Desarrollador</label><br>
                        <label><input type="checkbox" class="config-check"> Configurado el nivel de seguridad</label><br>
                        <label><input type="checkbox" class="config-check"> Probado el acceso al Editor VBA</label><br>
                        <button class="btn" onclick="checkConfiguration()">Verificar Configuraci√≥n</button>
                        <div class="feedback" id="feedback2"></div>
                    </div>
                `,
                quiz: {
                    question: "¬øCu√°l es el atajo de teclado para abrir el Editor VBA?",
                    options: [
                        "Ctrl + V",
                        "Alt + F11",
                        "Shift + F12",
                        "Ctrl + Alt + M"
                    ],
                    correct: 1
                }
            },
            {
                id: 3,
                title: "Grabadora de Macros",
                description: "Crea tu primera macro usando la grabadora autom√°tica",
                duration: "20 min",
                content: `
                    <h2>Tu Primera Macro con la Grabadora</h2>
                    <p>La grabadora de macros es la forma m√°s f√°cil de comenzar. Excel registra todas tus acciones y las convierte en c√≥digo VBA.</p>

                    <h3>Pasos para grabar una macro:</h3>
                    <ol>
                        <li><strong>Desarrollador</strong> ‚Üí <strong>Grabar macro</strong></li>
                        <li>Asigna un <strong>nombre</strong> (sin espacios)</li>
                        <li>Elige una <strong>tecla de m√©todo abreviado</strong> (opcional)</li>
                        <li>Selecciona d√≥nde <strong>guardar</strong> la macro</li>
                        <li>Realiza las <strong>acciones</strong> que quieres automatizar</li>
                        <li><strong>Desarrollador</strong> ‚Üí <strong>Detener grabaci√≥n</strong></li>
                    </ol>

                    <div class="code-example">
Sub MiPrimeraMacro()
    ' Ejemplo de macro grabada
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "Hola Mundo"
    Range("A1").Select
    With Selection.Font
        .Name = "Arial"
        .Size = 14
        .Bold = True
    End With
End Sub</div>

                    <div class="tip-box">
                        <strong>Consejo:</strong> Mientras grabas, cada clic y tecla se convierte en c√≥digo. ¬°S√© preciso en tus acciones!
                    </div>

                    <h3>Buenas pr√°cticas al grabar:</h3>
                    <ul>
                        <li>üéØ Planifica tus acciones antes de grabar</li>
                        <li>üö´ Evita acciones innecesarias</li>
                        <li>üìç Usa referencias relativas cuando sea apropiado</li>
                        <li>üè∑Ô∏è Usa nombres descriptivos para las macros</li>
                    </ul>

                    <div class="interactive-exercise">
                        <div class="exercise-title">üé¨ Pr√°ctica de Grabaci√≥n</div>
                        <p>Describe los pasos para crear una macro que:</p>
                        <p><strong>Objetivo:</strong> Formatear un t√≠tulo en la celda A1 con texto "REPORTE MENSUAL", Arial 16, negrita y centrado.</p>
                        <textarea class="exercise-input" placeholder="Escribe los pasos que seguir√≠as..." rows="6"></textarea>
                        <button class="btn" onclick="completeExercise(3)">Enviar Respuesta</button>
                        <div class="feedback" id="feedback3"></div>
                    </div>
                `,
                quiz: {
                    question: "¬øQu√© informaci√≥n NO es necesaria al crear una macro con la grabadora?",
                    options: [
                        "Nombre de la macro",
                        "Ubicaci√≥n donde guardar",
                        "N√∫mero de veces que se ejecutar√°",
                        "Descripci√≥n de la macro"
                    ],
                    correct: 2
                }
            },
            {
                id: 4,
                title: "Editor VBA B√°sico",
                description: "Navega y edita c√≥digo en el entorno de desarrollo",
                duration: "25 min",
                content: `
                    <h2>Conociendo el Editor VBA</h2>
                    <p>El Editor VBA es tu herramienta principal para crear, editar y depurar macros. Familiar√≠zate con su interfaz.</p>

                    <h3>Componentes principales:</h3>
                    <ul>
                        <li>üóÇÔ∏è <strong>Explorador de Proyectos:</strong> Navega entre libros y m√≥dulos</li>
                        <li>üìù <strong>Ventana de C√≥digo:</strong> Donde escribes y editas VBA</li>
                        <li>üîç <strong>Ventana de Propiedades:</strong> Configura objetos seleccionados</li>
                        <li>üñ•Ô∏è <strong>Ventana Inmediato:</strong> Prueba c√≥digo r√°pidamente</li>
                    </ul>

                    <h3>Estructura b√°sica de un m√≥dulo:</h3>
                    <div class="code-example">
' Esto es un comentario
Option Explicit  ' Obliga a declarar variables

Sub NombreDeLaMacro()
    ' C√≥digo de la macro aqu√≠
    MsgBox "¬°Hola desde VBA!"
End Sub

Function MiFuncion(parametro As String) As String
    MiFuncion = "Resultado: " & parametro
End Function</div>

                    <div class="tip-box">
                        <strong>Tip:</strong> Usa <strong>Option Explicit</strong> al inicio de cada m√≥dulo para evitar errores de variables no declaradas.
                    </div>

                    <h3>Atajos de teclado √∫tiles:</h3>
                    <ul>
                        <li><strong>F5:</strong> Ejecutar macro</li>
                        <li><strong>F8:</strong> Ejecutar paso a paso</li>
                        <li><strong>Ctrl + G:</strong> Mostrar ventana Inmediato</li>
                        <li><strong>Ctrl + R:</strong> Mostrar Explorador de Proyectos</li>
                        <li><strong>Ctrl + Espacio:</strong> Autocompletar c√≥digo</li>
                    </ul>

                    <div class="interactive-exercise">
                        <div class="exercise-title">üõ†Ô∏è Pr√°ctica con el Editor</div>
                        <p>Completa este c√≥digo VBA b√°sico:</p>
                        <textarea class="exercise-input" rows="8">Sub MiPrimeraMacro()
    ' Completa el c√≥digo para:
    ' 1. Mostrar un mensaje que diga "Bienvenido a VBA"
    ' 2. Escribir "Fecha actual" en la celda A1
    ' 3. Escribir la fecha de hoy en la celda B1
    
    _________ "Bienvenido a VBA"
    Range("A1").Value = _________
    Range("B1").Value = _________
End Sub</textarea>
                        <button class="btn" onclick="checkVBACode()">Verificar C√≥digo</button>
                        <div class="feedback" id="feedback4"></div>
                    </div>
                `,
                quiz: {
                    question: "¬øQu√© hace la declaraci√≥n 'Option Explicit' en VBA?",
                    options: [
                        "Hace que el c√≥digo sea m√°s r√°pido",
                        "Obliga a declarar todas las variables antes de usarlas",
                        "Permite usar funciones avanzadas",
                        "Oculta los errores de sintaxis"
                    ],
                    correct: 1
                }
            },
            {
                id: 5,
                title: "Variables y Tipos de Datos",
                description: "Aprende a declarar y usar variables en VBA",
                duration: "30 min",
                content: `
                    <h2>Variables en VBA</h2>
                    <p>Las variables son contenedores que almacenan datos temporalmente. Usar variables hace tu c√≥digo m√°s eficiente y legible.</p>

                    <h3>Declaraci√≥n de variables:</h3>
                    <div class="code-example">
' Declaraci√≥n expl√≠cita
Dim nombre As String
Dim edad As Integer
Dim salario As Double
Dim activo As Boolean

' Declaraci√≥n con asignaci√≥n
Dim mensaje As String
mensaje = "¬°Hola Excel!"

' Declaraci√≥n m√∫ltiple
Dim a As Integer, b As Integer, c As Integer</div>

                    <h3>Tipos de datos principales:</h3>
                    <ul>
                        <li>üìù <strong>String:</strong> Texto ("Hola", "Excel")</li>
                        <li>üî¢ <strong>Integer:</strong> N√∫meros enteros (-32,768 a 32,767)</li>
                        <li>üìä <strong>Long:</strong> N√∫meros enteros grandes</li>
                        <li>üí∞ <strong>Double:</strong> N√∫meros decimales</li>
                        <li>‚úÖ <strong>Boolean:</strong> Verdadero/Falso</li>
                        <li>üìÖ <strong>Date:</strong> Fechas y horas</li>
                        <li>üéØ <strong>Variant:</strong> Cualquier tipo (por defecto)</li>
                    </ul>

                    <div class="code-example">
Sub EjemploVariables()
    ' Declaraci√≥n de variables
    Dim nombreEmpleado As String
    Dim horasTrabajadas As Integer
    Dim tarifaPorHora As Double
    Dim salarioTotal As Double
    Dim fechaContrato As Date
    
    ' Asignaci√≥n de valores
    nombreEmpleado = "Juan P√©rez"
    horasTrabajadas = 40
    tarifaPorHora = 15.50
    fechaContrato = #1/15/2024#
    
    ' C√°lculo
    salarioTotal = horasTrabajadas * tarifaPorHora
    
    ' Mostrar resultado
    MsgBox "Empleado: " & nombreEmpleado & vbCrLf & _
           "Salario: $" & salarioTotal
End Sub</div>

                    <div class="tip-box">
                        <strong>Buena pr√°ctica:</strong> Siempre declara tus variables con el tipo espec√≠fico. Esto previene errores y mejora el rendimiento.
                    </div>

                    <h3>Alcance de las variables:</h3>
                    <ul>
                        <li><strong>Dim:</strong> Local al procedimiento</li>
                        <li><strong>Private:</strong> Visible solo en el m√≥dulo</li>
                        <li><strong>Public:</strong> Visible en todo el proyecto</li>
                        <li><strong>Static:</strong> Mantiene su valor entre llamadas</li>
                    </ul>

                    <div class="interactive-exercise">
                        <div class="exercise-title">üßÆ Calculadora Simple</div>
                        <p>Crea una macro que calcule el √°rea de un rect√°ngulo:</p>
                        <textarea class="exercise-input" rows="10">Sub CalcularArea()
    ' Completa el c√≥digo:
    ' 1. Declara variables para largo, ancho y √°rea
    ' 2. Asigna valores: largo = 15, ancho = 8
    ' 3. Calcula el √°rea
    ' 4. Muestra el resultado en un mensaje
    
    _______ largo As _______
    _______ ancho As _______
    _______ area As _______
    
    largo = _______
    ancho = _______
    area = _______
    
    MsgBox "El √°rea es: " & _______
End Sub</textarea>
                        <button class="btn" onclick="checkVariableExercise()">Verificar C√≥digo</button>
                        <div class="feedback" id="feedback5"></div>
                    </div>
                `,
                quiz: {
                    question: "¬øCu√°l es el tipo de dato m√°s apropiado para almacenar un precio con decimales?",
                    options: [
                        "Integer",
                        "String",
                        "Double",
                        "Boolean"
                    ],
                    correct: 2
                }
            },
            {
                id: 6,
                title: "Estructuras de Control",
                description: "If-Then-Else, bucles For y Do-While",
                duration: "35 min",
                content: `
                    <h2>Estructuras de Control en VBA</h2>
                    <p>Las estructuras de control te permiten crear l√≥gica en tus macros: tomar decisiones y repetir acciones.</p>

                    <h3>If-Then-Else (Condicionales)</h3>
                    <div class="code-example">
' Estructura b√°sica
If condici√≥n Then
    ' C√≥digo si es verdadero
Else
    ' C√≥digo si es falso
End If

' Ejemplo pr√°ctico
Sub EvaluarNota()
    Dim nota As Integer
    nota = 85
    
    If nota >= 90 Then
        MsgBox "Excelente"
    ElseIf nota >= 80 Then
        MsgBox "Muy bueno"
    ElseIf nota >= 70 Then
        MsgBox "Bueno"
    Else
        MsgBox "Necesita mejorar"
    End If
End Sub</div>

                    <h3>Bucles For (Repetici√≥n controlada)</h3>
                    <div class="code-example">
' Bucle For b√°sico
For i = 1 To 10
    Cells(i, 1).Value = "Fila " & i
Next i

' Bucle For con Step
For i = 10 To 1 Step -2
    MsgBox "Contador: " & i
Next i

' Bucle For Each (para colecciones)
Dim celda As Range
For Each celda In Range("A1:A10")
    celda.Value = celda.Value * 2
Next celda</div>

                    <h3>Bucles Do-While/Until</h3>
                    <div class="code-example">
' Do While (mientras sea verdadero)
Dim contador As Integer
contador = 1
Do While contador <= 5
    MsgBox "Vuelta " & contador
    contador = contador + 1
Loop

' Do Until (hasta que sea verdadero)
Dim fila As Integer
fila = 1
Do Until Cells(fila, 1).Value = ""
    fila = fila + 1
Loop</div>

                    <div class="tip-box">
                        <strong>Cuidado:</strong> Los bucles infinitos pueden bloquear Excel. Siempre aseg√∫rate de que la condici√≥n cambie dentro del bucle.
                    </div>

                    <h3>Select Case (M√∫ltiples opciones)</h3>
                    <div class="code-example">
Sub EvaluarDia()
    Dim dia As Integer
    dia = Weekday(Date)
    
    Select Case dia
        Case 1
            MsgBox "Domingo - D√≠a de descanso"
        Case 2 To 6
            MsgBox "D√≠a laboral"
        Case 7
            MsgBox "S√°bado - Fin de semana"
        Case Else
            MsgBox "D√≠a no v√°lido"
    End Select
End Sub</div>

                    <div class="interactive-exercise">
                        <div class="exercise-title">üéØ Pr√°ctica con Estructuras</div>
                        <p>Completa esta macro que eval√∫a ventas y asigna bonificaciones:</p>
                        <textarea class="exercise-input" rows="12">Sub CalcularBonificacion()
    Dim ventas As Double
    Dim bonificacion As Double
    
    ventas = 15000
    
    ' Completa la l√≥gica:
    ' Si ventas >= 20000: bonificaci√≥n = 10%
    ' Si ventas >= 10000: bonificaci√≥n = 5%
    ' Si ventas < 10000: bonificaci√≥n = 0%
    
    If _______ Then
        bonificacion = _______
    _______ ventas >= 10000 Then
        bonificacion = _______
    _______
        bonificacion = _______
    End If
    
    MsgBox "Bonificaci√≥n: " & Format(bonificacion, "0.00%")
End Sub</textarea>
                        <button class="btn" onclick="checkControlStructure()">Verificar C√≥digo</button>
                        <div class="feedback" id="feedback6"></div>
                    </div>
                `,
                quiz: {
                    question: "¬øCu√°l es la diferencia entre 'Do While' y 'Do Until'?",
                    options: [
                        "No hay diferencia, son sin√≥nimos",
                        "Do While ejecuta mientras la condici√≥n es verdadera, Do Until hasta que sea verdadera",
                        "Do While es m√°s r√°pido que Do Until",
                        "Do Until solo funciona con n√∫meros"
                    ],
                    correct: 1
                }
            },
            {
                id: 7,
                title: "Trabajando con Rangos",
                description: "Manipular celdas, rangos y hojas de c√°lculo",
                duration: "40 min",
                content: `
                    <h2>Manipulaci√≥n de Rangos en VBA</h2>
                    <p>Los rangos son el coraz√≥n de Excel. Aprender a manipularlos eficientemente es crucial para crear macros potentes.</p>

                    <h3>Formas de referenciar rangos:</h3>
                    <div class="code-example">
' Diferentes formas de referenciar celdas
Range("A1").Value = "Hola"
Cells(1, 1).Value = "Hola"          ' Fila 1, Columna 1
Range("A1:C3").Value = "Datos"
Range(Cells(1, 1), Cells(3, 3)).Value = "Rango din√°mico"

' Usando variables
Dim miRango As Range
Set miRango = Range("A1:B10")
miRango.Font.Bold = True</div>

                    <h3>Propiedades √∫tiles de rangos:</h3>
                    <div class="code-example">
Sub PropiedadesRangos()
    Dim rng As Range
    Set rng = Range("A1:C5")
    
    ' Propiedades de contenido
    rng.Value = "Texto"
    rng.Formula = "=SUM(A1:A5)"
    rng.NumberFormat = "$#,##0.00"
    
    ' Propiedades de formato
    rng.Font.Name = "Arial"
    rng.Font.Size = 12
    rng.Font.Bold = True
    rng.Interior.Color = RGB(255, 255, 0)  ' Amarillo
    
    ' Propiedades de informaci√≥n
    MsgBox "Filas: " & rng.Rows.Count
    MsgBox "Columnas: " & rng.Columns.Count
    MsgBox "Direcci√≥n: " & rng.Address
End Sub</div>

                    <h3>M√©todos importantes:</h3>
                    <div class="code-example">
Sub MetodosRangos()
    Dim rng As Range
    Set rng = Range("A1:C10")
    
    ' Limpiar contenido
    rng.ClearContents
    rng.ClearFormats
    rng.Clear  ' Limpia todo
    
    ' Copiar y pegar
    rng.Copy
    Range("E1").PasteSpecial xlPasteValues
    
    ' Encontrar y reemplazar
    rng.Replace What:="Viejo", Replacement:="Nuevo"
    
    ' Ordenar
    rng.Sort Key1:=Range("A1"), Order1:=xlAscending
    
    ' Autoajustar
    rng.Columns.AutoFit
    rng.Rows.AutoFit
End Sub</div>

                    <h3>Trabajando con rangos din√°micos:</h3>
                    <div class="code-example">
Sub RangosDinamicos()
    Dim ultimaFila As Long
    Dim ultimaColumna As Long
    Dim rngDatos As Range
    
    ' Encontrar √∫ltima fila con datos
    ultimaFila = Cells(Rows.Count, 1).End(xlUp).Row
    
    ' Encontrar √∫ltima columna con datos
    ultimaColumna = Cells(1, Columns.Count).End(xlToLeft).Column
    
    ' Crear rango din√°mico
    Set rngDatos = Range(Cells(1, 1), Cells(ultimaFila, ultimaColumna))
    
    ' Aplicar formato
    rngDatos.Borders.LineStyle = xlContinuous
End Sub</div>

                    <div class="tip-box">
                        <strong>Consejo:</strong> Usa siempre 'Set' cuando asignes objetos Range a variables. Sin 'Set', intentar√°s asignar el valor en lugar del objeto.
                    </div>

                    <h3>Iterando por rangos:</h3>
                    <div class="code-example">
Sub IterarRangos()
    Dim celda As Range
    Dim contador As Integer
    
    ' Iterar por cada celda
    For Each celda In Range("A1:A10")
        If celda.Value > 100 Then
            celda.Interior.Color = RGB(144, 238, 144)  ' Verde claro
        End If
    Next celda
    
    ' Iterar por filas
    For contador = 1 To 10
        If Cells(contador, 1).Value <> "" Then
            Cells(contador, 2).Value = "Procesado"
        End If
    Next contador
End Sub</div>

                    <div class="interactive-exercise">
                        <div class="exercise-title">üìä Ejercicio Pr√°ctico</div>
                        <p>Crea una macro que formatee una tabla de datos:</p>
                        <textarea class="exercise-input" rows="15">Sub FormatearTabla()
    ' Objetivo: Formatear el rango A1:D10 como tabla
    ' 1. Aplicar bordes a todo el rango
    ' 2. Hacer negrita la primera fila (encabezados)
    ' 3. Aplicar color de fondo azul claro a los encabezados
    ' 4. Centrar el texto de toda la tabla
    ' 5. Autoajustar el ancho de las columnas
    
    Dim rngTabla As Range
    Set rngTabla = Range("_______")
    
    ' Aplicar bordes
    rngTabla._______ = xlContinuous
    
    ' Formatear encabezados
    Range("A1:D1").Font._______ = True
    Range("A1:D1").Interior.Color = RGB(173, 216, 230)
    
    ' Centrar texto
    rngTabla.HorizontalAlignment = _______
    
    ' Autoajustar columnas
    rngTabla.Columns._______
End Sub</textarea>
                        <button class="btn" onclick="checkRangeExercise()">Verificar C√≥digo</button>
                        <div class="feedback" id="feedback7"></div>
                    </div>
                `,
                quiz: {
                    question: "¬øCu√°l es la diferencia entre Range('A1').Value y Range('A1').Formula?",
                    options: [
                        "No hay diferencia",
                        "Value obtiene el resultado, Formula obtiene la f√≥rmula",
                        "Formula es m√°s r√°pido que Value",
                        "Value solo funciona con n√∫meros"
                    ],
                    correct: 1
                }
            },
            {
                id: 8,
                title: "Funciones Personalizadas",
                description: "Crear funciones UDF (User Defined Functions)",
                duration: "30 min",
                content: `
                    <h2>Funciones Personalizadas (UDF)</h2>
                    <p>Las funciones personalizadas te permiten crear tus propias funciones de Excel, expandiendo las capacidades del programa.</p>

                    <h3>Estructura b√°sica de una funci√≥n:</h3>
                    <div class="code-example">
Function NombreFuncion(parametro1 As TipoDato, parametro2 As TipoDato) As TipoRetorno
    ' C√≥digo de la funci√≥n
    NombreFuncion = resultado
End Function

' Ejemplo simple
Function Saludar(nombre As String) As String
    Saludar = "Hola, " & nombre & "!"
End Function</div>

                    <h3>Funciones con m√∫ltiples par√°metros:</h3>
                    <div class="code-example">
Function CalcularImpuesto(precio As Double, tasa As Double) As Double
    CalcularImpuesto = precio * (tasa / 100)
End Function

Function DescuentoPorVolumen(cantidad As Integer, precio As Double) As Double
    Dim descuento As Double
    
    If cantidad >= 100 Then
        descuento = 0.15      ' 15% descuento
    ElseIf cantidad >= 50 Then
        descuento = 0.10      ' 10% descuento
    ElseIf cantidad >= 20 Then
        descuento = 0.05      ' 5% descuento
    Else
        descuento = 0         ' Sin descuento
    End If
    
    DescuentoPorVolumen = precio * cantidad * (1 - descuento)
End Function</div>

                    <h3>Funciones con rangos como par√°metros:</h3>
                    <div class="code-example">
Function ContarPares(rango As Range) As Integer
    Dim celda As Range
    Dim contador As Integer
    
    contador = 0
    For Each celda In rango
        If IsNumeric(celda.Value) Then
            If celda.Value Mod 2 = 0 Then
                contador = contador + 1
            End If
        End If
    Next celda
    
    ContarPares = contador
End Function

Function PromedioSinCeros(rango As Range) As Double
    Dim suma As Double
    Dim contador As Integer
    Dim celda As Range
    
    suma = 0
    contador = 0
    
    For Each celda In rango
        If IsNumeric(celda.Value) And celda.Value <> 0 Then
            suma = suma + celda.Value
            contador = contador + 1
        End If
    Next celda
    
    If contador > 0 Then
        PromedioSinCeros = suma / contador
    Else
        PromedioSinCeros = 0
    End If
End Function</div>

                    <div class="tip-box">
                        <strong>Importante:</strong> Las funciones UDF se pueden usar directamente en las celdas de Excel como =MiFuncion(A1, B1)
                    </div>

                    <h3>Funciones con par√°metros opcionales:</h3>
                    <div class="code-example">
Function FormatearTexto(texto As String, Optional mayuscula As Boolean = False) As String
    If mayuscula Then
        FormatearTexto = UCase(texto)
    Else
        FormatearTexto = texto
    End If
End Function

Function CalcularPago(capital As Double, tasa As Double, periodos As Integer, _
                     Optional tipo As Integer = 0) As Double
    ' Tipo 0 = pago al final del per√≠odo
    ' Tipo 1 = pago al inicio del per√≠odo
    
    If tipo = 0 Then
        CalcularPago = capital * (tasa / (1 - (1 + tasa) ^ -periodos))
    Else
        CalcularPago = capital * (tasa / (1 - (1 + tasa) ^ -periodos)) / (1 + tasa)
    End If
End Function</div>

                    <h3>Manejo de errores en funciones:</h3>
                    <div class="code-example">
Function DivisionSegura(numerador As Double, denominador As Double) As Variant
    On Error GoTo ManejadorError
    
    If denominador = 0 Then
        DivisionSegura = CVErr(xlErrDiv0)  ' Error de divisi√≥n por cero
    Else
        DivisionSegura = numerador / denominador
    End If
    
    Exit Function
    
ManejadorError:
    DivisionSegura = CVErr(xlErrValue)  ' Error de valor
End Function</div>

                    <div class="interactive-exercise">
                        <div class="exercise-title">üîß Crear tu Funci√≥n</div>
                        <p>Crea una funci√≥n que calcule el descuento por antig√ºedad del empleado:</p>
                        <textarea class="exercise-input" rows="12">Function DescuentoAntiguedad(salario As Double, a√±os As Integer) As Double
    ' Reglas de descuento:
    ' 0-2 a√±os: 5% descuento
    ' 3-5 a√±os: 10% descuento
    ' 6-10 a√±os: 15% descuento
    ' M√°s de 10 a√±os: 20% descuento
    
    Dim porcentajeDescuento As Double
    
    If a√±os <= 2 Then
        porcentajeDescuento = _______
    ElseIf a√±os <= 5 Then
        porcentajeDescuento = _______
    ElseIf a√±os <= 10 Then
        porcentajeDescuento = _______
    Else
        porcentajeDescuento = _______
    End If
    
    DescuentoAntiguedad = salario * _______
End Function</textarea>
                        <button class="btn" onclick="checkFunctionExercise()">Verificar Funci√≥n</button>
                        <div class="feedback" id="feedback8"></div>
                    </div>
                `,
                quiz: {
                    question: "¬øCu√°l es la principal diferencia entre una Sub y una Function en VBA?",
                    options: [
                        "Las Sub son m√°s r√°pidas",
                        "Las Function devuelven un valor, las Sub no",
                        "Las Sub pueden usar par√°metros, las Function no",
                        "No hay diferencia"
                    ],
                    correct: 1
                }
            },
            {
                id: 9,
                title: "Manejo de Errores",
                description: "Prevenir y manejar errores en tus macros",
                duration: "25 min",
                content: `
                    <h2>Manejo de Errores en VBA</h2>
                    <p>Los errores son inevitables en la programaci√≥n. Aprender a manejarlos correctamente hace que tus macros sean m√°s robustas y profesionales.</p>

                    <h3>Tipos de errores comunes:</h3>
                    <ul>
                        <li>üî¥ <strong>Errores de sintaxis:</strong> C√≥digo mal escrito</li>
                        <li>üü° <strong>Errores de tiempo de ejecuci√≥n:</strong> Problemas durante la ejecuci√≥n</li>
                        <li>üîµ <strong>Errores l√≥gicos:</strong> El c√≥digo funciona pero no hace lo esperado</li>
                    </ul>

                    <h3>Estructura b√°sica de manejo de errores:</h3>
                    <div class="code-example">
Sub EjemploManejoErrores()
    On Error GoTo ManejadorError
    
    ' C√≥digo que puede generar error
    Dim numero As Integer
    numero = 100 / 0  ' Esto generar√° error
    
    ' Si no hay error, salta el manejador
    Exit Sub
    
ManejadorError:
    ' C√≥digo para manejar el error
    MsgBox "Error: " & Err.Description
    MsgBox "N√∫mero de error: " & Err.Number
End Sub</div>

                    <h3>Diferentes estrategias de manejo:</h3>
                    <div class="code-example">
Sub EstrategiasManejo()
    ' On Error Resume Next - Ignora errores y contin√∫a
    On Error Resume Next
    Range("A1").Value = "Test"
    If Err.Number <> 0 Then
        MsgBox "Ocurri√≥ un error: " & Err.Description
        Err.Clear
    End If
    
    ' On Error GoTo 0 - Restaura manejo normal
    On Error GoTo 0
    
    ' On Error GoTo etiqueta - Salta a manejador espec√≠fico
    On Error GoTo MiManejador
    
    ' C√≥digo aqu√≠...
    Exit Sub
    
MiManejador:
    Select Case Err.Number
        Case 11
            MsgBox "Error de divisi√≥n por cero"
        Case 13
            MsgBox "Error de tipo de datos"
        Case Else
            MsgBox "Error desconocido: " & Err.Description
    End Select
End Sub</div>

                    <h3>Validaci√≥n preventiva:</h3>
                    <div class="code-example">
Function DivisionSegura(a As Double, b As Double) As Double
    ' Validar entrada antes de procesar
    If Not IsNumeric(a) Or Not IsNumeric(b) Then
        MsgBox "Los par√°metros deben ser n√∫meros"
        Exit Function
    End If
    
    If b = 0 Then
        MsgBox "No se puede dividir por cero"
        Exit Function
    End If
    
    DivisionSegura = a / b
End Function

Sub ValidarDatos()
    Dim rango As Range
    Set rango = Range("A1:A10")
    
    ' Verificar que el rango no est√© vac√≠o
    If WorksheetFunction.CountA(rango) = 0 Then
        MsgBox "El rango est√° vac√≠o"
        Exit Sub
    End If
    
    ' Verificar que contiene solo n√∫meros
    Dim celda As Range
    For Each celda In rango
        If celda.Value <> "" And Not IsNumeric(celda.Value) Then
            MsgBox "La celda " & celda.Address & " no contiene un n√∫mero v√°lido"
            Exit Sub
        End If
    Next celda
End Sub</div>

                    <h3>Logging de errores:</h3>
                    <div class="code-example">
Sub LoggearError(procedimiento As String, descripcionError As String)
    Dim archivoLog As String
    Dim numeroArchivo As Integer
    
    archivoLog = ThisWorkbook.Path & "\ErrorLog.txt"
    numeroArchivo = FreeFile
    
    Open archivoLog For Append As #numeroArchivo
    Print #numeroArchivo, Date & " " & Time & " - " & procedimiento & ": " & descripcionError
    Close #numeroArchivo
End Sub

Sub EjemploConLogging()
    On Error GoTo ManejadorError
    
    ' C√≥digo que puede fallar
    Dim resultado As Double
    resultado = 100 / 0
    
    Exit Sub
    
ManejadorError:
    LoggearError "EjemploConLogging", Err.Description
    MsgBox "Se ha registrado un error. Consulte el log para m√°s detalles."
End Sub</div>

                    <div class="tip-box">
                        <strong>Buena pr√°ctica:</strong> Siempre usa Exit Sub/Function antes del manejador de errores para evitar que se ejecute cuando no hay error.
                    </div>

                    <h3>Debugging con puntos de interrupci√≥n:</h3>
                    <div class="code-example">
Sub EjemploDebugging()
    Dim i As Integer
    
    For i = 1 To 10
        ' Coloca un punto de interrupci√≥n aqu√≠ (F9)
        Debug.Print "Iteraci√≥n: " & i
        
        ' Usar Debug.Print para ver valores
        If i = 5 Then
            Debug.Print "Llegamos al punto medio"
        End If
    Next i
End Sub</div>

                    <div class="interactive-exercise">
                        <div class="exercise-title">üõ°Ô∏è Macro Robusta</div>
                        <p>Mejora esta macro agregando manejo de errores:</p>
                        <textarea class="exercise-input" rows="15">Sub ProcesarDatosVentas()
    ' Agregar manejo de errores a esta macro
    
    _______ _______ _______ ManejadorError
    
    Dim ultimaFila As Long
    Dim i As Integer
    
    ultimaFila = Range("A" & Rows.Count).End(xlUp).Row
    
    ' Verificar si hay datos
    If ultimaFila < 2 Then
        MsgBox "No hay datos para procesar"
        _______ Sub
    End If
    
    For i = 2 To ultimaFila
        ' Calcular comisi√≥n (5% de ventas)
        Cells(i, 3).Value = Cells(i, 2).Value * 0.05
    Next i
    
    MsgBox "Proceso completado exitosamente"
    _______ Sub
    
ManejadorError:
    MsgBox "Error en ProcesarDatosVentas: " & _______
End Sub</textarea>
                        <button class="btn" onclick="checkErrorHandling()">Verificar C√≥digo</button>
                        <div class="feedback" id="feedback9"></div>
                    </div>
                `,
                quiz: {
                    question: "¬øQu√© hace la instrucci√≥n 'On Error Resume Next'?",
                    options: [
                        "Detiene la ejecuci√≥n cuando hay un error",
                        "Ignora los errores y contin√∫a con la siguiente l√≠nea",
                        "Env√≠a un mensaje de error al usuario",
                        "Reinicia la macro desde el principio"
                    ],
                    correct: 1
                }
            },
            {
                id: 10,
                title: "Proyecto Final",
                description: "Automatizar un reporte completo con m√∫ltiples funcionalidades",
                duration: "45 min",
                content: `
                    <h2>üéØ Proyecto Final: Sistema de Reportes Automatizado</h2>
                    <p>¬°Felicidades! Has llegado al proyecto final. Vamos a crear un sistema completo que combine todo lo aprendido.</p>

                    <h3>Objetivo del Proyecto:</h3>
                    <p>Crear un sistema que automatice la generaci√≥n de reportes de ventas con las siguientes caracter√≠sticas:</p>
                    <ul>
                        <li>üìä Importar y procesar datos de ventas</li>
                        <li>üßÆ Calcular estad√≠sticas autom√°ticamente</li>
                        <li>üìà Generar gr√°ficos din√°micos</li>
                        <li>üìã Crear un reporte formateado</li>
                        <li>üìß Opci√≥n de exportar a PDF</li>
                    </ul>

                    <h3>Estructura del Sistema:</h3>
                    <div class="code-example">
' M√≥dulo principal del sistema
Option Explicit

' Variables globales
Public Const HOJA_DATOS = "Datos"
Public Const HOJA_REPORTE = "Reporte"

Sub GenerarReporteCompleto()
    On Error GoTo ManejadorError
    
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    
    ' Paso 1: Validar datos
    If Not ValidarDatos() Then Exit Sub
    
    ' Paso 2: Limpiar reporte anterior
    LimpiarReporte
    
    ' Paso 3: Calcular estad√≠sticas
    CalcularEstadisticas
    
    ' Paso 4: Crear gr√°ficos
    CrearGraficos
    
    ' Paso 5: Formatear reporte
    FormatearReporte
    
    ' Paso 6: Mostrar resumen
    MostrarResumen
    
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic
    
    MsgBox "Reporte generado exitosamente", vbInformation
    Exit Sub
    
ManejadorError:
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic
    MsgBox "Error al generar reporte: " & Err.Description, vbCritical
End Sub</div>

                    <h3>Funciones del Sistema:</h3>
                    <div class="code-example">
Function ValidarDatos() As Boolean
    Dim wsData As Worksheet
    Dim ultimaFila As Long
    
    Set wsData = ThisWorkbook.Sheets(HOJA_DATOS)
    ultimaFila = wsData.Range("A" & Rows.Count).End(xlUp).Row
    
    If ultimaFila < 2 Then
        MsgBox "No hay datos en la hoja " & HOJA_DATOS, vbExclamation
        ValidarDatos = False
        Exit Function
    End If
    
    ' Verificar columnas requeridas
    If wsData.Range("A1").Value <> "Fecha" Or _
       wsData.Range("B1").Value <> "Vendedor" Or _
       wsData.Range("C1").Value <> "Producto" Or _
       wsData.Range("D1").Value <> "Cantidad" Or _
       wsData.Range("E1").Value <> "Precio" Then
        MsgBox "Formato de datos incorrecto. Verifique los encabezados.", vbExclamation
        ValidarDatos = False
        Exit Function
    End If
    
    ValidarDatos = True
End Function

Sub CalcularEstadisticas()
    Dim wsData As Worksheet, wsReporte As Worksheet
    Dim ultimaFila As Long
    Dim totalVentas As Double
    Dim ventaPromedio As Double
    Dim mejorVendedor As String
    
    Set wsData = ThisWorkbook.Sheets(HOJA_DATOS)
    Set wsReporte = ThisWorkbook.Sheets(HOJA_REPORTE)
    
    ultimaFila = wsData.Range("A" & Rows.Count).End(xlUp).Row
    
    ' Calcular total de ventas
    totalVentas = Application.WorksheetFunction.SumProduct( _
        wsData.Range("D2:D" & ultimaFila), _
        wsData.Range("E2:E" & ultimaFila))
    
    ' Calcular venta promedio
    ventaPromedio = totalVentas / (ultimaFila - 1)
    
    ' Encontrar mejor vendedor
    mejorVendedor = EncontrarMejorVendedor()
    
    ' Escribir estad√≠sticas en reporte
    With wsReporte
        .Range("B2").Value = "Total de Ventas:"
        .Range("C2").Value = totalVentas
        .Range("C2").NumberFormat = "$#,##0.00"
        
        .Range("B3").Value = "Venta Promedio:"
        .Range("C3").Value = ventaPromedio
        .Range("C3").NumberFormat = "$#,##0.00"
        
        .Range("B4").Value = "Mejor Vendedor:"
        .Range("C4").Value = mejorVendedor
    End With
End Sub

Function EncontrarMejorVendedor() As String
    Dim wsData As Worksheet
    Dim ultimaFila As Long
    Dim dictVendedores As Object
    Dim i As Long
    Dim vendedor As String
    Dim ventaActual As Double
    Dim mejorVendedor As String
    Dim mejorVenta As Double
    
    Set wsData = ThisWorkbook.Sheets(HOJA_DATOS)
    Set dictVendedores = CreateObject("Scripting.Dictionary")
    
    ultimaFila = wsData.Range("A" & Rows.Count).End(xlUp).Row
    
    ' Sumar ventas por vendedor
    For i = 2 To ultimaFila
        vendedor = wsData.Cells(i, 2).Value
        ventaActual = wsData.Cells(i, 4).Value * wsData.Cells(i, 5).Value
        
        If dictVendedores.exists(vendedor) Then
            dictVendedores(vendedor) = dictVendedores(vendedor) + ventaActual
        Else
            dictVendedores(vendedor) = ventaActual
        End If
    Next i
    
    ' Encontrar el mejor
    mejorVenta = 0
    For Each vendedor In dictVendedores.Keys
        If dictVendedores(vendedor) > mejorVenta Then
            mejorVenta = dictVendedores(vendedor)
            mejorVendedor = vendedor
        End If
    Next vendedor
    
    EncontrarMejorVendedor = mejorVendedor
End Function

Sub CrearGraficos()
    Dim wsReporte As Worksheet
    Dim wsData As Worksheet
    Dim grafico As Chart
    
    Set wsReporte = ThisWorkbook.Sheets(HOJA_REPORTE)
    Set wsData = ThisWorkbook.Sheets(HOJA_DATOS)
    
    ' Crear gr√°fico de ventas por vendedor
    Set grafico = wsReporte.ChartObjects.Add(Left:=50, Top:=150, Width:=400, Height:=250).Chart
    
    With grafico
        .ChartType = xlColumnClustered
        .HasTitle = True
        .ChartTitle.Text = "Ventas por Vendedor"
        .SetSourceData Source:=wsData.Range("B1:B10,E1:E10")
    End With
End Sub

Sub FormatearReporte()
    Dim wsReporte As Worksheet
    Set wsReporte = ThisWorkbook.Sheets(HOJA_REPORTE)
    
    With wsReporte
        .Range("A1").Value = "REPORTE DE VENTAS"
        .Range("A1").Font.Size = 16
        .Range("A1").Font.Bold = True
        .Range("A1").HorizontalAlignment = xlCenter
        
        .Range("B2:C4").Font.Bold = True
        .Columns("B:C").AutoFit
    End With
End Sub

Sub MostrarResumen()
    Dim mensaje As String
    mensaje = "Reporte generado exitosamente" & vbCrLf & _
              "- Estad√≠sticas calculadas" & vbCrLf & _
              "- Gr√°ficos creados" & vbCrLf & _
              "- Formato aplicado"
    
    MsgBox mensaje, vbInformation, "Sistema de Reportes"
End Sub</div>

                    <div class="interactive-exercise">
                        <div class="exercise-title">üéØ Proyecto Final</div>
                        <p>Implementa tu propio sistema de reportes:</p>
                        <p><strong>Instrucciones:</strong></p>
                        <ol>
                            <li>Crea una hoja llamada "Datos" con columnas: Fecha, Vendedor, Producto, Cantidad, Precio</li>
                            <li>Crea una hoja llamada "Reporte" donde se mostrar√°n los resultados</li>
                            <li>Implementa el sistema completo usando el c√≥digo proporcionado</li>
                            <li>Prueba con datos de ejemplo</li>
                        </ol>
                        <textarea class="exercise-input" placeholder="Describe tu implementaci√≥n y resultados..." rows="6"></textarea>
                        <button class="btn" onclick="completeExercise(10)">Completar Proyecto</button>
                        <div class="feedback" id="feedback10"></div>
                    </div>
                `,
                quiz: {
                    question: "¬øCu√°l es la ventaja principal de usar un sistema modular como este?",
                    options: [
                        "Es m√°s dif√≠cil de entender",
                        "Permite mantenimiento y depuraci√≥n m√°s f√°cil",
                        "Ocupa m√°s espacio en el archivo",
                        "Solo funciona en versiones nuevas de Excel"
                    ],
                    correct: 1
                }
            }
        ];

        // Estado del curso
        let currentLessonIndex = 0;
        let completedLessons = JSON.parse(localStorage.getItem('completedLessons') || '[]');

        // Inicializar el curso
        function initializeCourse() {
            console.log('Inicializando curso...');
            createStarsBackground();
            updateProgress();
            renderLessons();

            // Mostrar la primera lecci√≥n despu√©s de un peque√±o retraso
            setTimeout(() => {
                showLesson(0);
            }, 500);

            addScrollEffects();
        }

        // Crear efecto de estrellas en el fondo
        function createStarsBackground() {
            const starsContainer = document.createElement('div');
            starsContainer.className = 'stars-background';
            starsContainer.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: 0;
            `;

            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.style.cssText = `
                    position: absolute;
                    width: 2px;
                    height: 2px;
                    background: rgba(255, 255, 255, ${Math.random() * 0.8 + 0.2});
                    border-radius: 50%;
                    left: ${Math.random() * 100}%;
                    top: ${Math.random() * 100}%;
                    animation: twinkle ${Math.random() * 3 + 2}s ease-in-out infinite alternate;
                `;
                starsContainer.appendChild(star);
            }

            document.body.insertBefore(starsContainer, document.body.firstChild);

            // A√±adir CSS para el efecto twinkle
            const style = document.createElement('style');
            style.textContent = `
                @keyframes twinkle {
                    0% { opacity: 0.3; transform: scale(1); }
                    100% { opacity: 1; transform: scale(1.2); }
                }
            `;
            document.head.appendChild(style);
        }

        // A√±adir efectos de scroll
        function addScrollEffects() {
            window.addEventListener('scroll', () => {
                const scrolled = window.pageYOffset;
                const parallax = document.querySelector('.header');
                if (parallax) {
                    parallax.style.transform = `translateY(${scrolled * 0.5}px)`;
                }
            });
        }

        // Actualizar barra de progreso con animaci√≥n mejorada
        function updateProgress() {
            const progress = (completedLessons.length / lessons.length) * 100;
            const progressFill = document.getElementById('progressFill');

            progressFill.style.width = progress + '%';

            // Efecto de pulso cuando se completa una lecci√≥n
            if (progress > 0) {
                progressFill.style.animation = 'progressPulse 0.5s ease-in-out';
                setTimeout(() => {
                    progressFill.style.animation = '';
                }, 500);
            }
        }

        // Renderizar lista de lecciones con animaciones
        function renderLessons() {
            console.log('Renderizando lecciones...');
            const container = document.getElementById('lessonSelector');
            container.innerHTML = '';

            lessons.forEach((lesson, index) => {
                const isCompleted = completedLessons.includes(lesson.id);
                const isActive = index === currentLessonIndex;

                const lessonCard = document.createElement('div');
                lessonCard.className = `lesson-card ${isCompleted ? 'completed' : ''} ${isActive ? 'active' : ''}`;
                lessonCard.onclick = () => {
                    console.log(`Haciendo clic en lecci√≥n ${index + 1}: ${lesson.title}`);
                    showLesson(index);
                };

                // A√±adir retraso en la animaci√≥n para efecto escalonado
                lessonCard.style.animationDelay = `${index * 0.1}s`;

                lessonCard.innerHTML = `
                    <div class="completion-badge">‚úì</div>
                    <h3>${lesson.title}</h3>
                    <p>${lesson.description}</p>
                    <div class="lesson-duration">${lesson.duration}</div>
                `;

                // A√±adir efectos de hover din√°micos
                lessonCard.addEventListener('mouseenter', (e) => {
                    e.target.style.transform = 'translateY(-8px) scale(1.02) rotateX(5deg)';
                });

                lessonCard.addEventListener('mouseleave', (e) => {
                    e.target.style.transform = 'translateY(0) scale(1) rotateX(0deg)';
                });

                container.appendChild(lessonCard);
            });
            console.log(`Se renderizaron ${lessons.length} lecciones`);
        }

        // Mostrar lecci√≥n con transiciones mejoradas
        function showLesson(index) {
            console.log(`Mostrando lecci√≥n ${index + 1}:`, lessons[index].title);
            currentLessonIndex = index;
            const lesson = lessons[index];
            const lessonContent = document.getElementById('lessonContent');

            if (!lessonContent) {
                console.error('No se encontr√≥ el elemento lessonContent');
                return;
            }

            // Asegurar que el contenido est√© visible
            lessonContent.style.display = 'block';
            lessonContent.style.opacity = '0';
            lessonContent.style.transform = 'translateY(20px)';

            setTimeout(() => {
                lessonContent.innerHTML = `
                    <div class="lesson-content active">
                        ${lesson.content}
                        <div class="quiz-container">
                            <div class="quiz-question">${lesson.quiz.question}</div>
                            <div class="quiz-options">
                                ${lesson.quiz.options.map((option, i) => `
                                    <div class="quiz-option" onclick="selectQuizOption(${i}, ${lesson.quiz.correct})">
                                        ${option}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;

                console.log('Contenido HTML insertado, aplicando efectos...');

                // Efecto de fade in
                setTimeout(() => {
                    lessonContent.style.opacity = '1';
                    lessonContent.style.transform = 'translateY(0)';
                }, 50);

                document.getElementById('currentLesson').textContent = index + 1;
                document.getElementById('totalLessons').textContent = lessons.length;

                // Actualizar navegaci√≥n
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');

                prevBtn.disabled = index === 0;
                nextBtn.disabled = index === lessons.length - 1;

                prevBtn.style.opacity = index === 0 ? '0.5' : '1';
                nextBtn.style.opacity = index === lessons.length - 1 ? '0.5' : '1';

                renderLessons();

                // Scroll suave hacia el contenido
                setTimeout(() => {
                    lessonContent.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }, 200);

            }, 100);
        }

        // Navegar entre lecciones
        function navigateLesson(direction) {
            const newIndex = currentLessonIndex + direction;
            if (newIndex >= 0 && newIndex < lessons.length) {
                showLesson(newIndex);
            }
        }

        // Seleccionar opci√≥n de quiz
        function selectQuizOption(selectedIndex, correctIndex) {
            const options = document.querySelectorAll('.quiz-option');
            options.forEach((option, index) => {
                option.classList.remove('selected', 'correct', 'incorrect');
                if (index === selectedIndex) {
                    option.classList.add('selected');
                    if (index === correctIndex) {
                        option.classList.add('correct');
                        completeLesson(lessons[currentLessonIndex].id);
                    } else {
                        option.classList.add('incorrect');
                    }
                } else if (index === correctIndex) {
                    option.classList.add('correct');
                }
            });
        }

        // Completar lecci√≥n with efectos de celebraci√≥n
        function completeLesson(lessonId) {
            if (!completedLessons.includes(lessonId)) {
                completedLessons.push(lessonId);
                localStorage.setItem('completedLessons', JSON.stringify(completedLessons));
                updateProgress();
                renderLessons();

                // Efecto de celebraci√≥n
                createCelebrationEffect();

                // Mensaje de felicitaci√≥n
                setTimeout(() => {
                    if (completedLessons.length === lessons.length) {
                        showCompletionModal();
                    } else {
                        showLessonCompletedToast();
                    }
                }, 1000);
            }
        }

        // Crear efecto de celebraci√≥n con confeti
        function createCelebrationEffect() {
            const colors = ['#ff6b35', '#667eea', '#764ba2', '#f093fb', '#f5576c'];

            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.style.cssText = `
                        position: fixed;
                        width: 10px;
                        height: 10px;
                        background: ${colors[Math.floor(Math.random() * colors.length)]};
                        top: -10px;
                        left: ${Math.random() * window.innerWidth}px;
                        z-index: 1000;
                        border-radius: 50%;
                        pointer-events: none;
                        animation: confettiFall 3s ease-out forwards;
                    `;

                    document.body.appendChild(confetti);

                    setTimeout(() => {
                        confetti.remove();
                    }, 3000);
                }, i * 20);
            }

            // A√±adir CSS para el efecto de confeti
            if (!document.getElementById('confetti-style')) {
                const style = document.createElement('style');
                style.id = 'confetti-style';
                style.textContent = `
                    @keyframes confettiFall {
                        0% {
                            transform: translateY(0) rotate(0deg);
                            opacity: 1;
                        }
                        100% {
                            transform: translateY(100vh) rotate(720deg);
                            opacity: 0;
                        }
                    }
                    @keyframes progressPulse {
                        0%, 100% { transform: scaleY(1); }
                        50% { transform: scaleY(1.1); }
                    }
                `;
                document.head.appendChild(style);
            }
        }

        // Mostrar toast de lecci√≥n completada
        function showLessonCompletedToast() {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #10b981, #059669);
                color: white;
                padding: 15px 25px;
                border-radius: 10px;
                box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
                z-index: 1000;
                animation: slideInFromRight 0.5s ease-out;
            `;
            toast.innerHTML = 'üéâ ¬°Lecci√≥n completada!';

            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideOutToRight 0.5s ease-in forwards';
                setTimeout(() => toast.remove(), 500);
            }, 3000);

            // A√±adir CSS para las animaciones del toast
            if (!document.getElementById('toast-style')) {
                const style = document.createElement('style');
                style.id = 'toast-style';
                style.textContent = `
                    @keyframes slideInFromRight {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOutToRight {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
        }

        // Modal de completaci√≥n del curso
        function showCompletionModal() {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
                animation: fadeIn 0.5s ease-out;
            `;

            modal.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #667eea, #764ba2);
                    color: white;
                    padding: 40px;
                    border-radius: 20px;
                    text-align: center;
                    max-width: 500px;
                    margin: 20px;
                    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                    animation: bounceIn 0.6s ease-out;
                ">
                    <h2 style="font-size: 2.5rem; margin-bottom: 20px;">üéâ ¬°Felicitaciones! üéâ</h2>
                    <p style="font-size: 1.2rem; margin-bottom: 30px;">
                        Has completado todo el tutorial de Macros en Excel.<br>
                        ¬°Ahora eres un experto en VBA!
                    </p>
                    <button onclick="this.parentElement.parentElement.remove()" style="
                        background: rgba(255,255,255,0.2);
                        color: white;
                        border: 2px solid white;
                        padding: 15px 30px;
                        border-radius: 10px;
                        font-size: 1.1rem;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    " onmouseover="this.style.background='white'; this.style.color='#667eea';" 
                       onmouseout="this.style.background='rgba(255,255,255,0.2)'; this.style.color='white';">
                        Continuar
                    </button>
                </div>
            `;

            document.body.appendChild(modal);
        }

        // Completar ejercicio
        function completeExercise(lessonId) {
            const feedback = document.getElementById(`feedback${lessonId}`);
            feedback.className = 'feedback success';
            feedback.style.display = 'block';
            feedback.innerHTML = '‚úÖ ¬°Excelente trabajo! Has completado este ejercicio correctamente.';

            completeLesson(lessonId);
        }

        // Verificar configuraci√≥n (para la lecci√≥n 2)
        function checkConfiguration() {
            const checkboxes = document.querySelectorAll('.config-check');
            const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;
            const feedback = document.getElementById('feedback2');

            if (checkedCount >= 2) {
                feedback.className = 'feedback success';
                feedback.innerHTML = '‚úÖ ¬°Perfecto! Has configurado Excel correctamente para trabajar con macros.';
                completeLesson(2);
            } else {
                feedback.className = 'feedback error';
                feedback.innerHTML = '‚ùå Por favor, completa al menos 2 de las configuraciones antes de continuar.';
            }
            feedback.style.display = 'block';
        }

        // Funciones espec√≠ficas de verificaci√≥n
        function checkVBACode() {
            const input = document.querySelector('#lessonContent textarea').value;
            const feedback = document.getElementById('feedback4');

            if (input.includes('MsgBox') && input.includes('Range("A1")') && input.includes('Date')) {
                feedback.className = 'feedback success';
                feedback.innerHTML = '‚úÖ ¬°Perfecto! Has completado el c√≥digo VBA correctamente.';
                completeLesson(4);
            } else {
                feedback.className = 'feedback error';
                feedback.innerHTML = '‚ùå Revisa el c√≥digo. Aseg√∫rate de incluir MsgBox, Range("A1") y Date.';
            }
            feedback.style.display = 'block';
        }

        function checkVariableExercise() {
            const input = document.querySelector('#lessonContent textarea').value;
            const feedback = document.getElementById('feedback5');

            if (input.includes('Dim') && input.includes('Double') && input.includes('15 * 8')) {
                feedback.className = 'feedback success';
                feedback.innerHTML = '‚úÖ ¬°Excelente! Has declarado las variables correctamente.';
                completeLesson(5);
            } else {
                feedback.className = 'feedback error';
                feedback.innerHTML = '‚ùå Revisa las declaraciones de variables y el c√°lculo.';
            }
            feedback.style.display = 'block';
        }

        function checkControlStructure() {
            const input = document.querySelector('#lessonContent textarea').value;
            const feedback = document.getElementById('feedback6');

            if (input.includes('If') && input.includes('ElseIf') && input.includes('Else')) {
                feedback.className = 'feedback success';
                feedback.innerHTML = '‚úÖ ¬°Muy bien! Has implementado la estructura de control correctamente.';
                completeLesson(6);
            } else {
                feedback.className = 'feedback error';
                feedback.innerHTML = '‚ùå Revisa la estructura If-ElseIf-Else.';
            }
            feedback.style.display = 'block';
        }

        function checkRangeExercise() {
            const input = document.querySelector('#lessonContent textarea').value;
            const feedback = document.getElementById('feedback7');

            if (input.includes('Range') && input.includes('Borders') && input.includes('AutoFit')) {
                feedback.className = 'feedback success';
                feedback.innerHTML = '‚úÖ ¬°Genial! Has formateado la tabla correctamente.';
                completeLesson(7);
            } else {
                feedback.className = 'feedback error';
                feedback.innerHTML = '‚ùå Revisa el c√≥digo de formateo de rangos.';
            }
            feedback.style.display = 'block';
        }

        function checkFunctionExercise() {
            const input = document.querySelector('#lessonContent textarea').value;
            const feedback = document.getElementById('feedback8');

            if (input.includes('Function') && input.includes('porcentajeDescuento') && input.includes('End Function')) {
                feedback.className = 'feedback success';
                feedback.innerHTML = '‚úÖ ¬°Perfecto! Has creado la funci√≥n correctamente.';
                completeLesson(8);
            } else {
                feedback.className = 'feedback error';
                feedback.innerHTML = '‚ùå Revisa la estructura de la funci√≥n.';
            }
            feedback.style.display = 'block';
        }

        function checkErrorHandling() {
            const input = document.querySelector('#lessonContent textarea').value;
            const feedback = document.getElementById('feedback9');

            if (input.includes('On Error GoTo') && input.includes('Exit Sub') && input.includes('Err.Description')) {
                feedback.className = 'feedback success';
                feedback.innerHTML = '‚úÖ ¬°Excelente! Has implementado el manejo de errores correctamente.';
                completeLesson(9);
            } else {
                feedback.className = 'feedback error';
                feedback.innerHTML = '‚ùå Revisa la estructura de manejo de errores.';
            }
            feedback.style.display = 'block';
        }

        // Inicializar cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', initializeCourse);
    </script>
</body>

</html>